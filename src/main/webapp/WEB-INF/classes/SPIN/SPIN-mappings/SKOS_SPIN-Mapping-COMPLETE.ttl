# namespace declarations
# ----------------------
@prefix fn:        <http://www.w3.org/2005/xpath-functions#> .
@prefix sparql:    <http://www.w3.org/TR/2013/REC-sparql11-query-20130321/#> .
@prefix xsd:       <http://www.w3.org/2001/XMLSchema#> .
@prefix dcterms:   <http://purl.org/dc/terms#> .
@prefix rdf:       <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs:      <http://www.w3.org/2000/01/rdf-schema#> .
@prefix owl:       <http://www.w3.org/2002/07/owl#> .
@prefix sp:        <http://spinrdf.org/sp#> .
@prefix spin:      <http://spinrdf.org/spin#> .
@prefix smf:       <http://topbraid.org/sparqlmotionfunctions#> .
@prefix spif:      <http://spinrdf.org/spif#> . 
@prefix spl:       <http://spinrdf.org/spl#> .
@prefix spinowl:   <http://topbraid.org/spin/spinowl> .
@prefix spinx:     <http://spinrdf.org/spinx#> . 
@prefix functions: <http://www.example.org/functions#> .
@prefix templates: <http://www.example.org/templates#> .
@prefix sparql:    <http://www.w3.org/TR/sparql11-query/#> .
@prefix skos: <http://www.w3.org/2004/02/skos/core#> .
@prefix skosqc2spin: <http://constraints.org/skosqc2spin#> .
@prefix skosqc: <http://www.example.org/skosqc#> .

# class constraints
# -----------------
skos:Collection
	spin:constraint 
	    [   a skosqc2spin:LabelingAndDocumentationIssues-OmittedOrInvalidLanguageTags ] ,
		[   a skosqc2spin:LabelingAndDocumentationIssues-UndocumentedConcepts ] ,
		[   a skosqc2spin:LabelingAndDocumentationIssues-MissingLabels ] ,
		[   a skosqc2spin:LabelingAndDocumentationIssues-EmptyLabels ] ,
		[   a skosqc2spin:StructuralIssues-ValuelessAssociativeRelations ] ,
		[   a skosqc2spin:StructuralIssues-UnidirectionallyRelatedConcepts ] ,
		[   a skosqc2spin:StructuralIssues-UnidirectionallyRelatedConcepts-1 ] ,
		[   a skosqc2spin:StructuralIssues-UnidirectionallyRelatedConcepts-2 ] ,
		[   a skosqc2spin:LinkedDataSpecificIssues-UndefinedSKOSResources-1 ] ,
		[   a skosqc2spin:LinkedDataSpecificIssues-UndefinedSKOSResources-2 ] ,
		[   a skosqc2spin:LinkedDataSpecificIssues-UndefinedSKOSResources-3 ] ,
		[   a skosqc2spin:LinkedDataSpecificIssues-UndefinedSKOSResources-4 ] ,
		[   a skosqc2spin:LinkedDataSpecificIssues-HTTPURISchemeViolation ] ,
		[   a skosqc2spin:SKOSSemiFormalConsistencyIssues-InconsistentPreferredLabels ] .
skos:Concept
	spin:constraint 
	    [   a skosqc2spin:LabelingAndDocumentationIssues-OmittedOrInvalidLanguageTags ] ,
	    [   a skosqc2spin:LabelingAndDocumentationIssues-IncompleteLanguageCoverage-1 ] ,
	    [   a skosqc2spin:LabelingAndDocumentationIssues-IncompleteLanguageCoverage-2 ] ,
	    [   a skosqc2spin:LabelingAndDocumentationIssues-IncompleteLanguageCoverage-3 ] ,
		[   a skosqc2spin:LabelingAndDocumentationIssues-UndocumentedConcepts ] ,
		[   a skosqc2spin:LabelingAndDocumentationIssues-NoCommonLanguage ] ,
		[   a skosqc2spin:LabelingAndDocumentationIssues-OverlappingLabels ] ,
		[   a skosqc2spin:LabelingAndDocumentationIssues-MissingLabels ] ,
		[   a skosqc2spin:LabelingAndDocumentationIssues-EmptyLabels ] ,
		[   a skosqc2spin:LabelingAndDocumentationIssues-AmbiguousNotationReferences ] ,
		[   a skosqc2spin:StructuralIssues-ValuelessAssociativeRelations ] ,
		[   a skosqc2spin:StructuralIssues-HierarchicalRedundancy-1 ] ,
		[   a skosqc2spin:StructuralIssues-HierarchicalRedundancy-2 ] ,
		[   a skosqc2spin:StructuralIssues-ReflexiveRelations ] ,
		[   a skosqc2spin:StructuralIssues-OrphanConcepts ] ,
		[   a skosqc2spin:StructuralIssues-CyclicHierarchicalRelations ] ,
		[   a skosqc2spin:StructuralIssues-SolelyTransitivelyRelatedConcepts ] ,
		[   a skosqc2spin:StructuralIssues-UnidirectionallyRelatedConcepts-1 ] ,
		[   a skosqc2spin:StructuralIssues-UnidirectionallyRelatedConcepts-2 ] ,
		[   a skosqc2spin:LinkedDataSpecificIssues-UndefinedSKOSResources-1 ] ,
		[   a skosqc2spin:LinkedDataSpecificIssues-UndefinedSKOSResources-2 ] ,
		[   a skosqc2spin:LinkedDataSpecificIssues-UndefinedSKOSResources-3 ] ,
		[   a skosqc2spin:LinkedDataSpecificIssues-UndefinedSKOSResources-4 ] ,
		[   a skosqc2spin:LinkedDataSpecificIssues-HTTPURISchemeViolation ] ,
		[   a skosqc2spin:SKOSSemiFormalConsistencyIssues-InconsistentPreferredLabels ] .
skos:ConceptScheme
	spin:constraint 
	    [   a skosqc2spin:LabelingAndDocumentationIssues-OmittedOrInvalidLanguageTags ] ,
		[   a skosqc2spin:LabelingAndDocumentationIssues-UndocumentedConcepts ] ,
		[   a skosqc2spin:LabelingAndDocumentationIssues-MissingLabels ] ,
		[   a skosqc2spin:LabelingAndDocumentationIssues-EmptyLabels ] ,
		[   a skosqc2spin:StructuralIssues-ValuelessAssociativeRelations ] ,
		[   a skosqc2spin:StructuralIssues-UnidirectionallyRelatedConcepts ] ,
		[   a skosqc2spin:StructuralIssues-UnidirectionallyRelatedConcepts-1 ] ,
		[   a skosqc2spin:StructuralIssues-UnidirectionallyRelatedConcepts-2 ] ,
		[   a skosqc2spin:StructuralIssues-OmittedTopConcepts ] , 
		[   a skosqc2spin:LinkedDataSpecificIssues-UndefinedSKOSResources-1 ] ,
		[   a skosqc2spin:LinkedDataSpecificIssues-UndefinedSKOSResources-2 ] ,
		[   a skosqc2spin:LinkedDataSpecificIssues-UndefinedSKOSResources-3 ] ,
		[   a skosqc2spin:LinkedDataSpecificIssues-UndefinedSKOSResources-4 ] ,
		[   a skosqc2spin:LinkedDataSpecificIssues-HTTPURISchemeViolation ] ,
		[   a skosqc2spin:SKOSSemiFormalConsistencyIssues-InconsistentPreferredLabels ] .
skos:OrderedCollection
	spin:constraint 
	    [   a skosqc2spin:LabelingAndDocumentationIssues-OmittedOrInvalidLanguageTags ] ,
		[   a skosqc2spin:LabelingAndDocumentationIssues-UndocumentedConcepts ] ,
		[   a skosqc2spin:LabelingAndDocumentationIssues-MissingLabels ] ,
		[   a skosqc2spin:LabelingAndDocumentationIssues-EmptyLabels ] ,
		[   a skosqc2spin:StructuralIssues-ValuelessAssociativeRelations ] ,
		[   a skosqc2spin:StructuralIssues-UnidirectionallyRelatedConcepts ] ,
		[   a skosqc2spin:StructuralIssues-UnidirectionallyRelatedConcepts-1 ] ,
		[   a skosqc2spin:StructuralIssues-UnidirectionallyRelatedConcepts-2 ] ,
		[   a skosqc2spin:LinkedDataSpecificIssues-UndefinedSKOSResources-1 ] ,
		[   a skosqc2spin:LinkedDataSpecificIssues-UndefinedSKOSResources-2 ] ,
		[   a skosqc2spin:LinkedDataSpecificIssues-UndefinedSKOSResources-3 ] ,
		[   a skosqc2spin:LinkedDataSpecificIssues-UndefinedSKOSResources-4 ] ,
		[   a skosqc2spin:LinkedDataSpecificIssues-HTTPURISchemeViolation ] ,
		[   a skosqc2spin:SKOSSemiFormalConsistencyIssues-InconsistentPreferredLabels ] .

# Labeling and Documentation Issues - Omitted or Invalid Language Tags
# ---------------------
skosqc2spin:LabelingAndDocumentationIssues-OmittedOrInvalidLanguageTags
	a spin:ConstructTemplate ;
    rdfs:subClassOf spin:ConstructTemplates ;
    # spin:violationSource
    spin:labelTemplate "Labeling and Documentation Issues - Omitted or Invalid Language Tags" ; 
    spin:body [
        rdf:type sp:Construct ;
        sp:text """
            PREFIX skosqc2spin: <http://constraints.org/skosqc2spin#>
            CONSTRUCT {
                _:cv 
                	a spin:ConstraintViolation ;
                    spin:violationRoot ?this ;
                    rdfs:label ?violationMessage ;
                    spin:violationPath ?p .
            }
            WHERE {	  
			    # constraint
				# ----------

						
				# data
				# ----
				?this 
				    a [rdfs:subClassOf* skos:Concept] ;
				    ?p ?l . 
				BIND ( ( LANG ( ?l ) ) AS ?language ) . 
				
				# validation
				# ----------
				FILTER ( ?language = "" ) . 

#               violation message
#               -----
                BIND ( CONCAT( 
                    \"Omitted or invalid language tags of text literals | The language tag of the text literal '\", 
                    xsd:string( ?l ), 
                    \"' is omitted.\") 
                    AS ?violationMessage ) . 
            }
            """ ;
    ] .
    
# Labeling and Documentation Issues - Incomplete Language Coverage
# ---------------------
skosqc2spin:LabelingAndDocumentationIssues-IncompleteLanguageCoverage-1
	a spin:ConstructTemplate ;
    rdfs:subClassOf spin:ConstructTemplates ;
    # spin:violationSource
    spin:labelTemplate "Labeling and Documentation Issues - Incomplete Language Coverage" ; 
    spin:body [
        rdf:type sp:Construct ;
        sp:text """
            PREFIX skosqc2spin: <http://constraints.org/skosqc2spin#>
            CONSTRUCT {
                _:cv 
                	a spin:ConstraintViolation ;
                    spin:violationRoot ?this ;
                    rdfs:label ?violationMessage ;
                    spin:violationPath ?p .
            }
            WHERE {	  	
				# data
				# ----
				?this 
				    a [rdfs:subClassOf* skos:Concept] ;
				    ?p ?label1 .
				FILTER ( ?p != rdf:type ) .
				BIND ( ( LANG ( ?label1 ) ) AS ?language1 ) .
				FILTER ( ?language1 = "en" ) .

				# validation
				# ----------
				BIND ( skosqc2spin:cardinalityPropertyValuesOfSpecificLanguage( ?this, ?p, "en" ) AS ?en ) .
				BIND ( skosqc2spin:cardinalityPropertyValuesOfSpecificLanguage( ?this, ?p, "de" ) AS ?de ) .
				BIND ( skosqc2spin:cardinalityPropertyValuesOfSpecificLanguage( ?this, ?p, "fr" ) AS ?fr ) .
				FILTER ( ?de = 0 || ?fr = 0 ) .

                # testing
                # -------
#                BIND ( CONCAT( 
#                    \"label1: \", 
#                    xsd:string( ?label1 ), 
#                    \" | language1: \", 
#                    xsd:string( ?language1 ), 
#                    \" | number english property values: \", 
#                    xsd:string( ?en ), 
#                    \" | number german property values: \", 
#                    xsd:string( ?de ), 
#                    \" | number french property values: \", 
#                    xsd:string( ?fr ), 
#                    \"\") 
#                    AS ?violationMessage ) . 

				# violation message
                # -----------------
                BIND ( CONCAT( 
                    \"The languages en, de, fr should be covered by each property of each SKOS concept | \",
                    \"The property '\",
                    xsd:string( ?p ),
                    \"' has \",
                    xsd:string( ?en ),
                    \" english value(s), \",
                    xsd:string( ?de ),
                    \" german value(s), and \",
                    xsd:string( ?fr ),
                    \" french value(s)\",
                    \".\") 
                    AS ?violationMessage ) . 
            }
            """ ;
    ] .
    
skosqc2spin:LabelingAndDocumentationIssues-IncompleteLanguageCoverage-2
	a spin:ConstructTemplate ;
    rdfs:subClassOf spin:ConstructTemplates ;
    # spin:violationSource
    spin:labelTemplate "Labeling and Documentation Issues - Incomplete Language Coverage" ; 
    spin:body [
        rdf:type sp:Construct ;
        sp:text """
            PREFIX skosqc2spin: <http://constraints.org/skosqc2spin#>
            CONSTRUCT {
                _:cv 
                	a spin:ConstraintViolation ;
                    spin:violationRoot ?this ;
                    rdfs:label ?violationMessage ;
                    spin:violationPath ?p .
            }
            WHERE {	  	
				# data
				# ----
				?this 
				    a [rdfs:subClassOf* skos:Concept] ;
				    ?p ?label1 .
				FILTER ( ?p != rdf:type ) .
				BIND ( ( LANG ( ?label1 ) ) AS ?language1 ) .
				FILTER ( ?language1 = "de" ) . 
				
				# validation
				# ----------
				BIND ( skosqc2spin:cardinalityPropertyValuesOfSpecificLanguage( ?this, ?p, "en" ) AS ?en ) .
				BIND ( skosqc2spin:cardinalityPropertyValuesOfSpecificLanguage( ?this, ?p, "de" ) AS ?de ) .
				BIND ( skosqc2spin:cardinalityPropertyValuesOfSpecificLanguage( ?this, ?p, "fr" ) AS ?fr ) .
				FILTER ( ?en = 0 || ?fr = 0 ) .

                # violation message
                # -----------------
                BIND ( CONCAT( 
                    \"The languages en, de, fr should be covered by each property of each SKOS concept | \",
                    \"The property '\",
                    xsd:string( ?p ),
                    \"' has \",
                    xsd:string( ?en ),
                    \" english value(s), \",
                    xsd:string( ?de ),
                    \" german value(s), and \",
                    xsd:string( ?fr ),
                    \" french value(s)\",
                    \".\") 
                    AS ?violationMessage ) . 
            }
            """ ;
    ] .
    
skosqc2spin:LabelingAndDocumentationIssues-IncompleteLanguageCoverage-3
	a spin:ConstructTemplate ;
    rdfs:subClassOf spin:ConstructTemplates ;
    # spin:violationSource
    spin:labelTemplate "Labeling and Documentation Issues - Incomplete Language Coverage" ; 
    spin:body [
        rdf:type sp:Construct ;
        sp:text """
            PREFIX skosqc2spin: <http://constraints.org/skosqc2spin#>
            CONSTRUCT {
                _:cv 
                	a spin:ConstraintViolation ;
                    spin:violationRoot ?this ;
                    rdfs:label ?violationMessage ;
                    spin:violationPath ?p .
            }
            WHERE {	  	
				# data
				# ----
				?this 
				    a [rdfs:subClassOf* skos:Concept] ;
				    ?p ?label1 .
				FILTER ( ?p != rdf:type ) .
				BIND ( ( LANG ( ?label1 ) ) AS ?language1 ) .
				FILTER ( ?language1 = "fr" ) . 
				
				# validation
				# ----------
				BIND ( skosqc2spin:cardinalityPropertyValuesOfSpecificLanguage( ?this, ?p, "en" ) AS ?en ) .
				BIND ( skosqc2spin:cardinalityPropertyValuesOfSpecificLanguage( ?this, ?p, "de" ) AS ?de ) .
				BIND ( skosqc2spin:cardinalityPropertyValuesOfSpecificLanguage( ?this, ?p, "fr" ) AS ?fr ) .
				FILTER ( ?en = 0 || ?de = 0 ) .

                # violation message
                # -----------------
                BIND ( CONCAT( 
                    \"The languages en, de, fr should be covered by each property of each SKOS concept | \",
                    \"The property '\",
                    xsd:string( ?p ),
                    \"' has \",
                    xsd:string( ?en ),
                    \" english value(s), \",
                    xsd:string( ?de ),
                    \" german value(s), and \",
                    xsd:string( ?fr ),
                    \" french value(s)\",
                    \".\") 
                    AS ?violationMessage ) . 
            }
            """ ;
    ] .
    
# Labeling and Documentation Issues - No Common Language
# ---------------------
skosqc2spin:LabelingAndDocumentationIssues-NoCommonLanguage
	a spin:ConstructTemplate ;
    rdfs:subClassOf spin:ConstructTemplates ;
    # spin:violationSource
    spin:labelTemplate "Labeling and Documentation Issues - No Common Language" ; 
    spin:body [
        rdf:type sp:Construct ;
        sp:text """
            PREFIX skosqc2spin: <http://constraints.org/skosqc2spin#>
            CONSTRUCT {
                _:cv 
                	a spin:ConstraintViolation ;
                    spin:violationRoot ?this ;
                    rdfs:label ?violationMessage .
            }
            WHERE {	  	
				# data
				# ----
				?this 
				    a [rdfs:subClassOf* skos:Concept] .

				# validation
				# ----------
				# at least 1 literal in the same common language: en
				BIND ( skosqc2spin:cardinalityPropertyValuesInCommonLanguage( ?this, "en" ) AS ?cardinalityCommonLanguage ) .
				# FILTER ( ?cardinalityCommonLanguage = 0 ) .

                # testing
                # -------
#                BIND ( CONCAT( 
#                    \"label1: \", 
#                    xsd:string( ?label1 ), 
#                    \" | language1: \", 
#                    xsd:string( ?language1 ), 
#                    \" | number english property values: \", 
#                    xsd:string( ?en ), 
#                    \" | number german property values: \", 
#                    xsd:string( ?de ), 
#                    \" | number french property values: \", 
#                    xsd:string( ?fr ), 
#                    \"\") 
#                    AS ?violationMessage ) . 

				# violation message
                # -----------------
                BIND ( CONCAT( 
                    \"Each SKOS concept must have at least 1 literal in the same common language (en) | \",
                    \"The SKOS concept '\",
                    xsd:string( ?this ),
                    \"' has 0 literals in the same common language (en).\",
                    \"\") 
                    AS ?violationMessage ) . 
            }
            """ ;
    ] .

# Labeling and Documentation Issues - Undocumented Concepts
# ---------------------
skosqc2spin:LabelingAndDocumentationIssues-UndocumentedConcepts
	a spin:ConstructTemplate ;
    rdfs:subClassOf spin:ConstructTemplates ;
    # spin:violationSource
    spin:labelTemplate "Labeling and Documentation Issues - Undocumented Concepts" ; 
    spin:body [
        rdf:type sp:Construct ;
        sp:text """
            PREFIX skosqc2spin: <http://constraints.org/skosqc2spin#>
            CONSTRUCT {
                _:cv 
                	a spin:ConstraintViolation ;
                    spin:violationRoot ?this ;
                    rdfs:label ?violationMessage ;
                    spin:violationPath skos:note ;
                    spin:violationPath skos:changeNote ;
                    spin:violationPath skos:definition ;
                    spin:violationPath skos:editorialNote ;
                    spin:violationPath skos:example ;
                    spin:violationPath skos:historyNote ;
                    spin:violationPath skos:scopeNote .
            }
            WHERE {	  
			    # constraint
				# ----------

						
				# data
				# ----
				?this a ?class .
				?class rdfs:subClassOf* skos:Concept .
				
				# validation
				# ----------
				FILTER NOT EXISTS { 
				    { { ?this skos:note ?x } UNION { ?this skos:changeNote ?x } . }
				    UNION 
				    { { ?this skos:definition ?x } UNION { ?this skos:editorialNote ?x } . }
				    UNION 
				    { { ?this skos:example ?x } UNION { ?this skos:historyNote ?x } . }
				    UNION 
				    { ?this skos:scopeNote ?x } .
				} 
					
#               testing
#               -------
#                BIND ( CONCAT( 
#                    \"this: \", 
#                    xsd:string( ?this ),
#                    \" | class: \", 
#                    xsd:string( ?class )
#                    ) AS ?violationMessage ) .  

                # violation message
                # -----
                BIND ( CONCAT( 
                    \"The concept '\", 
                    xsd:string( ?this ), 
                    \"' does not use one of skos:note, skos:changeNote, skos:definition, skos:editorialNote, skos:example, skos:historyNote, or skos:scopeNote.\") 
                    AS ?violationMessage ) . 
            }
            """ ;
    ] .
    
# Labeling and Documentation Issues - Overlapping Labels
# ---------------------
skosqc2spin:LabelingAndDocumentationIssues-OverlappingLabels
	a spin:ConstructTemplate ;
    rdfs:subClassOf spin:ConstructTemplates ;
    # spin:violationSource
    spin:labelTemplate "Labeling and Documentation Issues - Overlapping Labels" ; 
    spin:body [
        rdf:type sp:Construct ;
        sp:text """
            PREFIX skosqc2spin: <http://constraints.org/skosqc2spin#>
            CONSTRUCT {
                _:cv 
                	a spin:ConstraintViolation ;
                    spin:violationRoot ?this ;
                    rdfs:label ?violationMessage ;
                    spin:violationPath ?p .
            }
            WHERE {		
				# data
				# ----
				?this 
				    a [rdfs:subClassOf* skos:Concept] ;
				    skos:inScheme ?conceptScheme ;
				    ?p ?label1 .
				BIND ( ( STR ( ?label1 ) ) AS ?l1 ) .
				BIND ( ( LANG ( ?label1 ) ) AS ?lang1 ) .
				?concept 
				    a [rdfs:subClassOf* skos:Concept] .
				    skos:inScheme ?conceptScheme ;
				    ?p ?label2 .
				BIND ( ( STR ( ?label2 ) ) AS ?l2 ) .
				BIND ( ( LANG ( ?label2 ) ) AS ?lang2 ) .
				?conceptScheme
				    a [rdfs:subClassOf* skos:ConceptScheme] .
				    
				# validation
				# ----------
				FILTER ( ?l1 = ?l2 ) .
				FILTER ( ?lang1 = ?lang2 ) . 

                # violation message
                # -----
                BIND ( CONCAT( 
                    \"Two SKOS concepts cannot have the same preferred lexical label in a given language when they belong to the same SKOS concept scheme | '\", 
                    \"The SKOS concept '\", 
                    xsd:string( ?this ), 
                    \"' and the SKOS concept '\",
                    xsd:string( ?concept ), 
                    \"', belonging to the same concept scheme '\",
                    xsd:string( ?conceptScheme ), 
                    \"', have the same preferred lexical label '\",
                    xsd:string( ?label ), 
                    \"' in the given language '\",
                    xsd:string( ?language ), 
                    \"'.'\"
                    ) AS ?violationMessage ) . 
            }
            """ ;
    ] .
    
# Labeling and Documentation Issues - Missing Labels
# ---------------------
skosqc2spin:LabelingAndDocumentationIssues-MissingLabels
	a spin:ConstructTemplate ;
    rdfs:subClassOf spin:ConstructTemplates ;
    # spin:violationSource
    spin:labelTemplate "Labeling and Documentation Issues - Missing Labels" ; 
    spin:body [
        rdf:type sp:Construct ;
        sp:text """
            PREFIX skosqc2spin: <http://constraints.org/skosqc2spin#>
            CONSTRUCT {
                _:cv 
                	a spin:ConstraintViolation ;
                    spin:violationRoot ?this ;
                    rdfs:label ?violationMessage ;
                    spin:violationPath skos:prefLabel ;
                    spin:violationPath skos:altLabel ;
                    spin:violationPath rdfs:label ;
                    spin:violationPath dcterms:title .
            }
            WHERE {	  	
				# data
				# ----
				{ { ?this a [rdfs:subClassOf* skos:Concept] } UNION { ?this a [rdfs:subClassOf* skos:ConceptScheme] } . }
			    UNION 
			    { { ?this a [rdfs:subClassOf* skos:Collection] } UNION { ?this a [rdfs:subClassOf* skos:OrderedCollection] } . }
   
				# validation
				# ----------
				FILTER NOT EXISTS {
			        { { ?this skos:prefLabel ?l } UNION { ?this skos:altLabel ?l } . }
			        UNION 
			        { { ?this rdfs:label ?l } UNION { ?this dcterms:title ?l } . }
			    } 

                # violation message
                # -----
                BIND ( CONCAT( 
                    \"SKOS classes ( Concept, ConceptScheme, Collection, OrderedCollection ) should be labeled with e.g. skos:prefLabel, skos:altLabel, rdfs:label, dcterms:title '\", 
                    \"( to make the vocabulary more convenient for humans to use ) | \",  
                    xsd:string( ?this ), 
                    \"' is not labeled.\"
                    ) AS ?violationMessage ) . 
            }
            """ ;
    ] .
    
# Labeling and Documentation Issues - Empty Labels
# ---------------------
skosqc2spin:LabelingAndDocumentationIssues-EmptyLabels
	a spin:ConstructTemplate ;
    rdfs:subClassOf spin:ConstructTemplates ;
    # spin:violationSource
    spin:labelTemplate "Labeling and Documentation Issues - Empty Labels" ; 
    spin:body [
        rdf:type sp:Construct ;
        sp:text """
            PREFIX skosqc2spin: <http://constraints.org/skosqc2spin#>
            CONSTRUCT {
                _:cv 
                	a spin:ConstraintViolation ;
                    spin:violationRoot ?this ;
                    rdfs:label ?violationMessage ;
                    spin:violationPath ?p .
            }
            WHERE {	  	
				# data
				# ----
				?this ?p ?l .
   
				# validation
				# ----------
				FILTER ( ?l = "" ) . 

                # violation message
                # -----
                BIND ( CONCAT( 
                    \"Labels are needed to contain textual information to be useful | The property '\",  
                    xsd:string( ?p ), 
                    \"' points to an empty label.\"
                    ) AS ?violationMessage ) . 
            }
            """ ;
    ] .
    
# Labeling and Documentation Issues - Ambiguous Notation References
# ---------------------
skosqc2spin:LabelingAndDocumentationIssues-AmbiguousNotationReferences
	a spin:ConstructTemplate ;
    rdfs:subClassOf spin:ConstructTemplates ;
    # spin:violationSource
    spin:labelTemplate "Labeling and Documentation Issues - Ambiguous Notation References" ; 
    spin:body [
        rdf:type sp:Construct ;
        sp:text """
            PREFIX skosqc2spin: <http://constraints.org/skosqc2spin#>
            CONSTRUCT {
                _:cv 
                	a spin:ConstraintViolation ;
                    spin:violationRoot ?this ;
                    rdfs:label ?violationMessage ;
                    spin:violationPath ?p .
            }
            WHERE {	  	
				# data
				# ----
				?this 
				    a [rdfs:subClassOf* skos:Concept] ;
				    skos:inScheme ?conceptScheme ;
				    skos:notation ?l .
				?concept 
				    a [rdfs:subClassOf* skos:Concept] .
				    skos:inScheme ?conceptScheme ;
				    skos:notation ?l .
				?conceptScheme
				    a [rdfs:subClassOf* skos:ConceptScheme] .
				    
				# validation
				# ----------
				

                # violation message
                # -----
                BIND ( CONCAT( 
                    \"Concepts with the same concept scheme should not have identical skos:notation literals | The concept '\",  
                    xsd:string( ?this ), 
                    \"' and the concept '\",
                    xsd:string( ?concept ), 
                    \"' with the same the concept scheme '\",
                    xsd:string( ?conceptScheme ), 
                    \"' have the identical skos:notation literal '\",
                    xsd:string( ?l ), 
                    \"'.\"
                    ) AS ?violationMessage ) . 
            }
            """ ;
    ] .
    
# Structural Issues - Orphan Concepts
# ---------------------
skosqc2spin:StructuralIssues-OrphanConcepts
	a spin:ConstructTemplate ;
    rdfs:subClassOf spin:ConstructTemplates ;
    # spin:violationSource
    spin:labelTemplate "Structural Issues - Orphan Concepts" ; 
    spin:body [
        rdf:type sp:Construct ;
        sp:text """
            PREFIX skosqc2spin: <http://constraints.org/skosqc2spin#>
            CONSTRUCT {
                _:cv 
                	a spin:ConstraintViolation ;
                    spin:violationRoot ?this ;
                    rdfs:label ?violationMessage ;
                    spin:violationPath ?p .
            }
            WHERE {	  
            	# data
            	# ----
				?this a [rdfs:subClassOf* skos:Concept] .
				    
				# validation
				# ----------
				#FILTER NOT EXISTS {
			    #    { { ?this skos:prefLabel ?l } UNION { ?this skos:altLabel ?l } . }
			    #    UNION 
			    #    { { ?this rdfs:label ?l } UNION { ?this dcterms:title ?l } . }
			    #}

#               violation message
#               -----
                BIND ( CONCAT( 
                    \"The concept '\", 
                    xsd:string( ?this ), 
                    \"' does not have any associative or hierarchical relations.\",
                    \" | XXXXX explanation XXXXX \") 
                    AS ?violationMessage ) . 
            }
            """ ;
    ] .
    
# Structural Issues - Disconnected Concept Clusters
# Tarjan's algorithm
# ---------------------
skosqc2spin:StructuralIssues-DisconnectedConceptClusters
	a spin:ConstructTemplate ;
    rdfs:subClassOf spin:ConstructTemplates ;
    # spin:violationSource
    spin:labelTemplate "Structural Issues - Disconnected Concept Clusters" ; 
    spin:body [
        rdf:type sp:Construct ;
        sp:text """
            PREFIX skosqc2spin: <http://constraints.org/skosqc2spin#>
            CONSTRUCT {
                _:cv 
                	a spin:ConstraintViolation ;
                    spin:violationRoot ?this ;
                    rdfs:label ?violationMessage ;
                    spin:violationPath ?p .
            }
            WHERE {	  
            	# data
            	# ----
				
				    
				# validation
				# ----------
				

#               violation message
#               -----
                BIND ( CONCAT( 
                    \"The concept '\", 
                    xsd:string( ?this ), 
                    \"' does not have any associative or hierarchical relations.\",
                    \" | XXXXX explanation XXXXX \") 
                    AS ?violationMessage ) . 
            }
            """ ;
    ] .
    
# Structural Issues - Cyclic Hierarchical Relations
# ---------------------
skosqc2spin:StructuralIssues-CyclicHierarchicalRelations
	a spin:ConstructTemplate ;
    rdfs:subClassOf spin:ConstructTemplates ;
    # spin:violationSource
    spin:labelTemplate "Structural Issues - Cyclic Hierarchical Relations" ; 
    spin:body [
        rdf:type sp:Construct ;
        sp:text """
            PREFIX skosqc2spin: <http://constraints.org/skosqc2spin#>
            CONSTRUCT {
                _:cv 
                	a spin:ConstraintViolation ;
                    spin:violationRoot ?this ;
                    rdfs:label ?violationMessage ;
                    spin:violationPath skos:broader .
            }
            WHERE {	  
            	# data
            	# ----
				?this a [rdfs:subClassOf* skos:Concept] .
				    
				# validation
				# ----------
				?this skos:broader* ?this .

#               violation message
#               -----
                BIND ( CONCAT( 
                    \"There is a cyclic relation between of the concept '\", 
                    xsd:string( ?this ), 
                    \"'. | XXXXX explanation XXXXX \") 
                    AS ?violationMessage ) . 
            }
            """ ;
    ] .
    
# Structural Issues - Valueless Associative Relations
# ---------------------
skosqc2spin:StructuralIssues-ValuelessAssociativeRelations
	a spin:ConstructTemplate ;
    rdfs:subClassOf spin:ConstructTemplates ;
    # spin:violationSource
    spin:labelTemplate "Structural Issues - Valueless Associative Relations" ; 
    spin:body [
        rdf:type sp:Construct ;
        sp:text """
            PREFIX skosqc2spin: <http://constraints.org/skosqc2spin#>
            CONSTRUCT {
                _:cv 
                	a spin:ConstraintViolation ;
                    spin:violationRoot ?this ;
                    rdfs:label ?violationMessage ;
                    spin:violationPath skos:related ;
                    spin:violationPath skos:broader ;
                    spin:violationPath skos:narrower .
            }
            WHERE {	  
				?this 
				    a [rdfs:subClassOf* skos:Concept] ;
				    skos:related ?sibling ;
				    skos:broader ?TopConcept ;
                    skos:narrower ?BottomConcept .
				
				?sibling 
				    a [rdfs:subClassOf* skos:Concept] ; 
				    skos:related ?this ;
				    skos:broader ?TopConcept ;
                    skos:narrower ?BottomConcept .
				
				?TopConcept 
				    a [rdfs:subClassOf* skos:Concept] .
				    
				?BottomConcept 
				    a [rdfs:subClassOf* skos:Concept] .		 

#               violation message
#               -----
                BIND ( CONCAT( 
                    \"The concepts '\", 
                    xsd:string( ?this ), 
                    \"' and '\", 
                    xsd:string( ?sibling ),
                    \"' are siblings (having the same broader or narrower concepts), but are also connected by a not necessary associative relation (skos:related).\") 
                    AS ?violationMessage ) . 
            }
            """ ;
    ] .
    
# Structural Issues - Solely Transitively Related Concepts
# ---------------------
skosqc2spin:StructuralIssues-SolelyTransitivelyRelatedConcepts
	a spin:ConstructTemplate ;
    rdfs:subClassOf spin:ConstructTemplates ;
    # spin:violationSource
    spin:labelTemplate "Structural Issues - Solely Transitively Related Concepts" ; 
    spin:body [
        rdf:type sp:Construct ;
        sp:text """
            PREFIX skosqc2spin: <http://constraints.org/skosqc2spin#>
            CONSTRUCT {
                _:cv 
                	a spin:ConstraintViolation ;
                    spin:violationRoot ?this ;
                    rdfs:label ?violationMessage ;
                    spin:violationPath ?p .
            }
            WHERE {	  
            	# data
            	# ----
				?this a [rdfs:subClassOf* skos:Concept] .
				    
				# validation
				# ----------
				# transitive SKOS properties
				#FILTER EXISTS {
			    #    { { ?this skos:prefLabel ?l } UNION { ?this skos:altLabel ?l } . }
			    #    UNION 
			    #    { { ?this rdfs:label ?l } UNION { ?this dcterms:title ?l } . }
			    #}
				# skos:broader and skos:narrower sub-properties
				#FILTER NOT EXISTS {
			    #    { { ?this skos:prefLabel ?l } UNION { ?this skos:altLabel ?l } . }
			    #    UNION 
			    #    { { ?this rdfs:label ?l } UNION { ?this dcterms:title ?l } . }
			    #}

#               violation message
#               -----
                BIND ( CONCAT( 
                    \"The concept '\", 
                    xsd:string( ?this ),
                    \"' is only related to the concept '\", 
                    xsd:string( ?concept ), 
                    \"' by transitive propertes ('\",
                    xsd:string( ?p ), 
                    \"'), but not by skos:broader and skos:narrower sub-properties. | XXXXX explanation XXXXX \") ) 
                    AS ?violationMessage ) . 
            }
            """ ;
    ] .
    
# Structural Issues - Unidirectionally Related Concepts
# ---------------------
skosqc2spin:StructuralIssues-UnidirectionallyRelatedConcepts-1
	a spin:ConstructTemplate ;
    rdfs:subClassOf spin:ConstructTemplates ;
    # spin:violationSource
    spin:labelTemplate "Structural Issues - Unidirectionally Related Concepts" ; 
    spin:body [
        rdf:type sp:Construct ;
        sp:text """
            PREFIX skosqc2spin: <http://constraints.org/skosqc2spin#>
            CONSTRUCT {
                _:cv 
                	a spin:ConstraintViolation ;
                    spin:violationRoot ?this ;
                    rdfs:label ?violationMessage ;
                    spin:violationPath ?p .
            }
            WHERE {	  
            	# data
            	# ----
            	?this ?p1 ?x . 
				FILTER ( ?p1 = skos:broader ) .
				    
				# validation
				# ----------
				# for all inverse SKOS properties
				# unidirectional relation --> constraint violation
				?x ?p2 ?this . 
				FILTER ( ?p2 = skos:narrower ) . 
				
#               violation message
#               -----
                BIND ( CONCAT( 
                    \"The concept '\", 
                    xsd:string( ?this ),
                    \"' is related to the concept '\", 
                    xsd:string( ?concept ), 
                    \"' by the property ('\",
                    xsd:string( ?p ), 
                    \"')only unidirectionally. | XXXXX explanation XXXXX \") ) 
                    AS ?violationMessage ) . 
            }
            """ ;
    ] .
    
skosqc2spin:StructuralIssues-UnidirectionallyRelatedConcepts-2
	a spin:ConstructTemplate ;
    rdfs:subClassOf spin:ConstructTemplates ;
    # spin:violationSource
    spin:labelTemplate "Structural Issues - Unidirectionally Related Concepts" ; 
    spin:body [
        rdf:type sp:Construct ;
        sp:text """
            PREFIX skosqc2spin: <http://constraints.org/skosqc2spin#>
            CONSTRUCT {
                _:cv 
                	a spin:ConstraintViolation ;
                    spin:violationRoot ?this ;
                    rdfs:label ?violationMessage ;
                    spin:violationPath ?p .
            }
            WHERE {	  
            	# data
            	# ----
            	?this ?p1 ?x . 
				FILTER ( ?p1 = skos:hasTopConcept ) .
				    
				# validation
				# ----------
				# unidirectional relation --> constraint violation
				?x ?p2 ?this . 
				FILTER ( ?p2 = skos:topConceptOf ) . 
				
#               violation message
#               -----
                BIND ( CONCAT( 
                    \"The concept '\", 
                    xsd:string( ?this ),
                    \"' is related to the concept '\", 
                    xsd:string( ?concept ), 
                    \"' by the property ('\",
                    xsd:string( ?p ), 
                    \"')only unidirectionally. | XXXXX explanation XXXXX \") ) 
                    AS ?violationMessage ) . 
            }
            """ ;
    ] .
    
# Structural Issues - Omitted Top Concepts
# ---------------------
skosqc2spin:StructuralIssues-OmittedTopConcepts
	a spin:ConstructTemplate ;
    rdfs:subClassOf spin:ConstructTemplates ;
    # spin:violationSource
    spin:labelTemplate "Structural Issues - Omitted Top Concepts" ; 
    spin:body [
        rdf:type sp:Construct ;
        sp:text """
            PREFIX skosqc2spin: <http://constraints.org/skosqc2spin#>
            CONSTRUCT {
                _:cv 
                	a spin:ConstraintViolation ;
                    spin:violationRoot ?this ;
                    rdfs:label ?violationMessage ;
                    spin:violationPath skos:hasTopConcept ;
                    spin:violationPath skos:topConceptOf .
            }
            WHERE {	  
            	# data
            	# ----
            	?this
            	    a [rdfs:subClassOf* skos:ConceptScheme] .
				    
				# validation
				# ----------
				{
					FILTER NOT EXISTS {
					    ?this 
					        skos:hasTopConcept ?concept .
					    ?concept
					        a [rdfs:subClassOf* skos:Concept] .
					} 
			    }
			    UNION
			    {
					FILTER NOT EXISTS {
					    ?concept
					        a [rdfs:subClassOf* skos:Concept] ;
					        skos:topConceptOf ?conceptScheme .
					}
			    }
				
#               violation message
#               -----
                BIND ( CONCAT( 
                    \"The concept scheme '\", 
                    xsd:string( ?this ),
                    \"' does not have any top concept | A vocabulary should provide 'entry points' to the data ro provide 'efficient access' (SKOS primer) and guidance for human users.\") ) 
                    AS ?violationMessage ) . 
            }
            """ ;
    ] .
    
# Structural Issues - Hierarchical Redundancy
# ---------------------
skosqc2spin:StructuralIssues-HierarchicalRedundancy-1
	a spin:ConstructTemplate ;
    rdfs:subClassOf spin:ConstructTemplates ;
    # spin:violationSource
    spin:labelTemplate "Structural Issues - Hierarchical Redundancy" ; 
    spin:body [
        rdf:type sp:Construct ;
        sp:text """
            PREFIX skosqc2spin: <http://constraints.org/skosqc2spin#>
            CONSTRUCT {
                _:cv 
                	a spin:ConstraintViolation ;
                    spin:violationRoot ?this ;
                    rdfs:label ?violationMessage ;
                    spin:violationPath skos:broader .
            }
            WHERE {	  
				?this 
				    a [rdfs:subClassOf* skos:Concept] ;
				    skos:broader ?B ;
				    skos:broader ?C .
				
				?B 
				    a [rdfs:subClassOf* skos:Concept] ; 
				    skos:broader* ?C .
				    
				?C
				    a [rdfs:subClassOf* skos:Concept] .	 
				    
				FILTER ( ?this != ?B ) .
				FILTER ( ?this != ?C ) .
				FILTER ( ?B != ?C ) .

#               violation message
#               -----
                BIND ( CONCAT( 
                    \"As stated in the SKOS reference document, skos:broader and skos:narrower are not transitive properties. | The SKOS concept '\", 
                    xsd:string( ?this ), 
                    \"' is directly related ( skos:broader ) to the SKOS concept '\", 
                    xsd:string( ?B ),
                    \"' and transitively related ( skos:broader ) to the SKOS concept '\", 
                    xsd:string( ?C ),
                    \"'.\") 
                    AS ?violationMessage ) . 
            }
            """ ;
    ] .
# Structural Issues - Hierarchical Redundancy
# ---------------------
skosqc2spin:StructuralIssues-HierarchicalRedundancy-2
	a spin:ConstructTemplate ;
    rdfs:subClassOf spin:ConstructTemplates ;
    # spin:violationSource
    spin:labelTemplate "Structural Issues - Hierarchical Redundancy" ; 
    spin:body [
        rdf:type sp:Construct ;
        sp:text """
            PREFIX skosqc2spin: <http://constraints.org/skosqc2spin#>
            CONSTRUCT {
                _:cv 
                	a spin:ConstraintViolation ;
                    spin:violationRoot ?this ;
                    rdfs:label ?violationMessage ;
                    spin:violationPath skos:narrower .
            }
            WHERE {	  
				?this 
				    a [rdfs:subClassOf* skos:Concept] ;
				    skos:narrower ?B ;
				    skos:narrower ?C .
				
				?B 
				    a [rdfs:subClassOf* skos:Concept] ; 
				    skos:narrower* ?C .
				    
				?C
				    a [rdfs:subClassOf* skos:Concept] .	 
				    
				FILTER ( ?this != ?B ) .
				FILTER ( ?this != ?C ) .
				FILTER ( ?B != ?C ) .

#               violation message
#               -----
                BIND ( CONCAT( 
                    \"As stated in the SKOS reference document, skos:broader and skos:narrower are not transitive properties. | The SKOS concept '\", 
                    xsd:string( ?this ), 
                    \"' is directly related ( skos:narrower ) to the SKOS concept '\", 
                    xsd:string( ?B ),
                    \"' and transitively related ( skos:narrower ) to the SKOS concept '\", 
                    xsd:string( ?C ),
                    \"'.\") 
                    AS ?violationMessage ) . 
            }
            """ ;
    ] .
    
# Structural Issues - Reflexive Relations
# ---------------------
skosqc2spin:StructuralIssues-ReflexiveRelations
	a spin:ConstructTemplate ;
    rdfs:subClassOf spin:ConstructTemplates ;
    # spin:violationSource
    spin:labelTemplate "Structural Issues - Reflexive Relations" ; 
    spin:body [
        rdf:type sp:Construct ;
        sp:text """
            PREFIX skosqc2spin: <http://constraints.org/skosqc2spin#>
            CONSTRUCT {
                _:cv 
                	a spin:ConstraintViolation ;
                    spin:violationRoot ?this ;
                    rdfs:label ?violationMessage ;
                    spin:violationPath ?p .
            }
            WHERE {	  
            	# data
            	# ----
				?this a [rdfs:subClassOf* skos:Concept] .
				    
				# validation
				# ----------
				?this ?p ?this .

#               violation message
#               -----
                BIND ( CONCAT( 
                    \"Reflexive SKOS concepts are not allowed. | The SKOS concept '\", 
                    xsd:string( ?this ), 
                    \"' is related to itself via the property '\",
                    xsd:string( ?p ),
                    \"'.\") 
                    AS ?violationMessage ) . 
            }
            """ ;
    ] .
    
# Linked Data Specific Issues - Undefined SKOS Resources
# ---------------------
skosqc2spin:LinkedDataSpecificIssues-UndefinedSKOSResources-1
	a spin:ConstructTemplate ;
    rdfs:subClassOf spin:ConstructTemplates ;
    # spin:violationSource
    spin:labelTemplate "Linked Data Specific Issues - Undefined SKOS Resources" ; 
    spin:body [
        rdf:type sp:Construct ;
        sp:text """
            PREFIX skosqc2spin: <http://constraints.org/skosqc2spin#>
            CONSTRUCT {
                _:cv 
                	a spin:ConstraintViolation ;
                    spin:violationRoot ?this ;
                    rdfs:label ?violationMessage ;
                    spin:violationPath ?property .
            }
            WHERE {	  
				# data
				# ----
				?this ?property ?x .
				
				# validation
				# ----------
				# deprecated SKOS elements ( appendix D of the SKOS reference )
				FILTER ( ?property IN ( 
				    skos:symbol, 
				    skos:prefSymbol, 
				    skos:altSymbol, 
				    skos:CollectableProperty,
				    skos:subject,
				    skos:isSubjectOf,
				    skos:primarySubject,
				    skos:isPrimarySubjectOf,
				    skos:subjectIndicator ) ) .	 

#               violation message
#               -----
                BIND ( CONCAT( 
                    \"The deprecated SKOS property '\", 
                    xsd:string( ?property ),
                    \"' is used.\") 
                    AS ?violationMessage ) . 
            }
            """ ;
    ] .
    
skosqc2spin:LinkedDataSpecificIssues-UndefinedSKOSResources-2
	a spin:ConstructTemplate ;
    rdfs:subClassOf spin:ConstructTemplates ;
    # spin:violationSource
    spin:labelTemplate "Linked Data Specific Issues - Undefined SKOS Resources" ; 
    spin:body [
        rdf:type sp:Construct ;
        sp:text """
            PREFIX skosqc2spin: <http://constraints.org/skosqc2spin#>
            CONSTRUCT {
                _:cv 
                	a spin:ConstraintViolation ;
                    spin:violationRoot ?this ;
                    rdfs:label ?violationMessage ;
                    spin:violationPath ?property .
            }
            WHERE {	  
				# data
				# ----
				?this ?property ?x .
				# property is a SKOS property
				FILTER( REGEX( STR( ?property ), "^http://www.w3.org/2004/02/skos/core#", "i" ) ) 
				
				# validation
				# ----------
				# SKOS property is defined within SKOS namespace
				FILTER ( ?property NOT IN ( 
				    skos:altLabel, 
				    skos:broadMatch,
				    skos:broader,
				    skos:broaderTransitive,
				    skos:changeNote,
				    skos:closeMatch,
				    skos:definition,
				    skos:editorialNote,
				    skos:exactMatch,
				    skos:example,
				    skos:hasTopConcept,
				    skos:hiddenLabel,
				    skos:historyNote,
				    skos:inScheme,
				    skos:mappingRelation,
				    skos:member,
				    skos:memberList,
				    skos:narrowMatch,
				    skos:narrower,
				    skos:narrowerTransitive,
				    skos:notation,
				    skos:note,
				    skos:prefLabel,
				    skos:related,
				    skos:relatedMatch,
				    skos:scopeNote,
				    skos:semanticRelation,
				    skos:topConceptOf ) ) .
				# property is not a deprecated SKOS property ( appendix D of the SKOS reference )
				FILTER ( ?property NOT IN ( 
				    skos:symbol, 
				    skos:prefSymbol, 
				    skos:altSymbol, 
				    skos:CollectableProperty,
				    skos:subject,
				    skos:isSubjectOf,
				    skos:primarySubject,
				    skos:isPrimarySubjectOf,
				    skos:subjectIndicator ) ) .		 

#               violation message
#               -----
                BIND ( CONCAT( 
                    \"The vocabulary invents the new SKOS property '\", 
                    xsd:string( ?property ),
                    \"'.\") 
                    AS ?violationMessage ) . 
            }
            """ ;
    ] .
    
skosqc2spin:LinkedDataSpecificIssues-UndefinedSKOSResources-3
	a spin:ConstructTemplate ;
    rdfs:subClassOf spin:ConstructTemplates ;
    # spin:violationSource
    spin:labelTemplate "Linked Data Specific Issues - Undefined SKOS Resources" ; 
    spin:body [
        rdf:type sp:Construct ;
        sp:text """
            PREFIX skosqc2spin: <http://constraints.org/skosqc2spin#>
            CONSTRUCT {
                _:cv 
                	a spin:ConstraintViolation ;
                    spin:violationRoot ?this ;
                    rdfs:label ?violationMessage ;
                    spin:violationPath rdf:type .
            }
            WHERE {	  
            	# data 
            	# ----
				?this a ?c . 

				# validation
				# ----------
				# class has SKOS namespace prefix
				FILTER( REGEX( STR( ?c ), "^http://www.w3.org/2004/02/skos/core#" ) ) .	
				# SKOS class is NOT defined within SKOS namespace
				FILTER ( ?c NOT IN ( 
				    skos:Concept, 
				    skos:Collection,
				    skos:ConceptScheme,
				    skos:OrderedCollection ) ) . 		
				
#               violation message
#               -----
                BIND ( CONCAT( 
                    \"The vocabulary invents the new SKOS class '\", 
                    xsd:string( ?c ),
                    \"'.\") 
                    AS ?violationMessage ) . 
            }
            """ ;
    ] .
    
skosqc2spin:LinkedDataSpecificIssues-UndefinedSKOSResources-4
	a spin:ConstructTemplate ;
    rdfs:subClassOf spin:ConstructTemplates ;
    # spin:violationSource
    spin:labelTemplate "Linked Data Specific Issues - Undefined SKOS Resources" ; 
    spin:body [
        rdf:type sp:Construct ;
        sp:text """
            PREFIX skosqc2spin: <http://constraints.org/skosqc2spin#>
            CONSTRUCT {
                _:cv 
                	a spin:ConstraintViolation ;
                    spin:violationRoot ?this ;
                    rdfs:label ?violationMessage ;
                    spin:violationPath rdf:type .
            }
            WHERE {	  
                # data
                # ----
				?this a ?subc .
				?subc rdfs:subClassOf* ?c . 
				
				# validation
				# ----------
				# indirect class has SKOS namespace prefix
				FILTER( REGEX( STR( ?c ), "^http://www.w3.org/2004/02/skos/core#" ) ) .	
				# SKOS class is NOT defined within SKOS namespace
				FILTER ( ?c NOT IN ( 
				    skos:Concept, 
				    skos:Collection,
				    skos:ConceptScheme,
				    skos:OrderedCollection ) ) . 

#               violation message
#               -----
                BIND ( CONCAT( 
                    \"The vocabulary invents the new SKOS class '\", 
                    xsd:string( ?c ),
                    \"'Test.\") 
                    AS ?violationMessage ) . 
            }
            """ ;
    ] .
    
# Linked Data Specific Issues - HTTP URI Scheme Violation
# ---------------------
skosqc2spin:LinkedDataSpecificIssues-HTTPURISchemeViolation
	a spin:ConstructTemplate ;
    rdfs:subClassOf spin:ConstructTemplates ;
    # spin:violationSource
    spin:labelTemplate "Linked Data Specific Issues - HTTP URI Scheme Violation" ; 
    spin:body [
        rdf:type sp:Construct ;
        sp:text """
            PREFIX skosqc2spin: <http://constraints.org/skosqc2spin#>
            CONSTRUCT {
                _:cv 
                	a spin:ConstraintViolation ;
                    spin:violationRoot ?this ;
                    rdfs:label ?violationMessage .
            }
            WHERE {	  
				# data
				# ----
				
				# validation
				# ----------
				# URI does not start with 'http'
				FILTER( REGEX( STR( ?this ), "^(?!http).+" ) ) .	 

#               violation message
#               -----
                BIND ( CONCAT( 
                    \"In the context of Linked Data, we restrict ourselves to using HTTP URIs only and avoid other URI schemes such as URNs and DOIs.\")
                    AS ?violationMessage ) . 
            }
            """ ;
    ] .
    
# SKOS Semi-Formal Consistency Issues - Inconsistent Preferred Labels
# ---------------------
skosqc2spin:SKOSSemiFormalConsistencyIssues-InconsistentPreferredLabels
	a spin:ConstructTemplate ;
    rdfs:subClassOf spin:ConstructTemplates ;
    # spin:violationSource
    spin:labelTemplate "SKOS Semi-Formal Consistency Issues - Inconsistent Preferred Labels" ; 
    spin:body [
        rdf:type sp:Construct ;
        sp:text """
            PREFIX skosqc2spin: <http://constraints.org/skosqc2spin#>
            CONSTRUCT {
                _:cv 
                	a spin:ConstraintViolation ;
                    spin:violationRoot ?this ;
                    rdfs:label ?violationMessage ;
                    spin:violationPath skos:prefLabel .
            }
            WHERE {	  	
				# data
				# ----
				?this skos:prefLabel ?label1 .
				?this skos:prefLabel ?label2 .
				
				BIND ( ( STR ( ?label1 ) ) AS ?label1Str ) .
				BIND ( ( STR ( ?label2 ) ) AS ?label2Str ) . 
				BIND ( ( LANG ( ?label1 ) ) AS ?language1 ) . 
				BIND ( ( LANG ( ?label2 ) ) AS ?language2 ) . 
				
				# validation
				# ----------
				FILTER ( ?label1 != ?label2 ) .
				FILTER ( ?label1Str != ?label2Str ) .
				FILTER ( ?language1 = ?language2 ) .

#               violation message
#               -----
                BIND ( CONCAT( 
                    \"A resource has no more than one value of skos:prefLabel per language tag | The resource '\", 
                    xsd:string( ?this ),
                    \"' has more than one value of skos:prefLabel: '\",
                    xsd:string( ?label1Str ), 
                    \"' and '\",
                    xsd:string( ?label2Str ),
                    \"' for the language tag '\",
                    xsd:string( ?language1 ), 
                    \"'.\" 
                    ) AS ?violationMessage ) . 
            }
            """ ;
    ] .
    
skosqc2spin:cardinalityPropertyValuesOfSpecificLanguage
    rdf:type spin:Function ;
    rdfs:subClassOf spin:Functions ;
    rdfs:label "cardinality property value of specific language" ;
    rdfs:comment "cardinality property value of specific language" ;
    spin:constraint [
        rdf:type spl:Argument ;
        spl:predicate sp:arg1 ;
        spl:valueType rdf:subject ;
        rdfs:comment "subject" ; 
    ] ;
    spin:constraint [
        rdf:type spl:Argument ;
        spl:predicate sp:arg2 ;
        spl:valueType rdf:Property ;
        rdfs:comment "property" ; 
    ] ;
    spin:constraint [
        rdf:type spl:Argument ;
        spl:predicate sp:arg3 ;
        spl:valueType xsd:string ;
        rdfs:comment "language" ; 
    ] ;
    spin:body [
        rdf:type sp:Select ;
        sp:text """
            SELECT ( COUNT ( ?arg1 ) AS ?cardinality)
            WHERE {
                ?arg1 ?arg2 ?literal1 .
                BIND ( ( LANG ( ?literal1 ) ) AS ?language1 ) .
                FILTER ( ?language1 = ?arg3 ) .
            }
        """ ;
    ] ;
    spin:returnType xsd:nonNegativeInteger .
    
skosqc2spin:cardinalityPropertyValuesInCommonLanguage
    rdf:type spin:Function ;
    rdfs:subClassOf spin:Functions ;
    rdfs:label "cardinality property values in common language" ;
    rdfs:comment "cardinality property values in common language" ;
    spin:constraint [
        rdf:type spl:Argument ;
        spl:predicate sp:arg1 ;
        spl:valueType rdf:subject ;
        rdfs:comment "subject" ; 
    ] ;
    spin:constraint [
        rdf:type spl:Argument ;
        spl:predicate sp:arg2 ;
        spl:valueType xsd:string ;
        rdfs:comment "language" ; 
    ] ;
    spin:body [
        rdf:type sp:Select ;
        sp:text """
            SELECT ( COUNT ( ?arg1 ) AS ?cardinality)
            WHERE {
                ?arg1 ?p ?literal .
                FILTER ( ?p != rdf:type ) .
                BIND ( ( LANG ( ?literal ) ) AS ?language ) .
                #FILTER ( ?language = ?arg2 ) .
            }
        """ ;
    ] ;
    spin:returnType xsd:nonNegativeInteger .